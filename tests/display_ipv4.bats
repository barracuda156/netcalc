#!/usr/bin/env bats

load helper_ipv4

# Address  : 192.168.1.0          11000000.10101000.00000001. 00000000
# Netmask  : 255.255.255.0 = 24   11111111.11111111.11111111. 00000000
# Wildcard : 0.0.0.255            00000000.00000000.00000000. 11111111
# =>
# Network  : 192.168.1.0/24       11000000.10101000.00000001. 00000000
# HostMin  : 192.168.1.1          11000000.10101000.00000001. 00000001
# HostMax  : 192.168.1.254        11000000.10101000.00000001. 11111110
# Broadcast: 192.168.1.255        11000000.10101000.00000001. 11111111
# Hosts/Net: 254                   Class C, Private network (RFC1918)

@test "netcalc display IPv4 class C private address" {
  run ./netcalc -n 192.168.1.0/24
  [ $status -eq 0 ]
  check_ipv4_display_output \
    "11000000.10101000.00000001." \
    "192.168.1.0 00000000" \
    "255.255.255.0 24 11111111.11111111.11111111. 00000000" \
    "0.0.0.255 00000000.00000000.00000000. 11111111" \
    "192.168.1.0/24 00000000" \
    "192.168.1.1 00000001" \
    "192.168.1.254 11111110" \
    "192.168.1.255 11111111" \
    "254" \
    "Class C, Private network (RFC1918)" \
    lines
}

# Address  : 172.17.0.0           10101100.00010001. 00000000.00000000
# Netmask  : 255.255.0.0 = 16     11111111.11111111. 00000000.00000000
# Wildcard : 0.0.255.255          00000000.00000000. 11111111.11111111
# =>
# Network  : 172.17.0.0/16        10101100.00010001. 00000000.00000000
# HostMin  : 172.17.0.1           10101100.00010001. 00000000.00000001
# HostMax  : 172.17.255.254       10101100.00010001. 11111111.11111110
# Broadcast: 172.17.255.255       10101100.00010001. 11111111.11111111
# Hosts/Net: 65534                 Class B, Private network (RFC1918)

@test "netcalc display IPv4 class B private address" {
  run ./netcalc -n 172.17.0.0/16
  [ $status -eq 0 ]
  check_ipv4_display_output \
    "10101100.00010001." \
    "172.17.0.0 00000000.00000000" \
    "255.255.0.0 16 11111111.11111111. 00000000.00000000" \
    "0.0.255.255 00000000.00000000. 11111111.11111111" \
    "172.17.0.0/16 00000000.00000000" \
    "172.17.0.1 00000000.00000001" \
    "172.17.255.254 11111111.11111110" \
    "172.17.255.255 11111111.11111111" \
    "65534" \
    "Class B, Private network (RFC1918)" \
    lines
}

# Address  : 10.0.0.0             00001010. 00000000.00000000.00000000
# Netmask  : 255.0.0.0 = 8        11111111. 00000000.00000000.00000000
# Wildcard : 0.255.255.255        00000000. 11111111.11111111.11111111
# =>
# Network  : 10.0.0.0/8           00001010. 00000000.00000000.00000000
# HostMin  : 10.0.0.1             00001010. 00000000.00000000.00000001
# HostMax  : 10.255.255.254       00001010. 11111111.11111111.11111110
# Broadcast: 10.255.255.255       00001010. 11111111.11111111.11111111
# Hosts/Net: 16777214              Class A, Private network (RFC1918)

@test "netcalc display IPv4 class A private address" {
  run ./netcalc -n 10.0.0.0/8
  [ $status -eq 0 ]
  check_ipv4_display_output \
    "00001010." \
    "10.0.0.0 00000000.00000000.00000000" \
    "255.0.0.0 8 11111111. 00000000.00000000.00000000" \
    "0.255.255.255 00000000. 11111111.11111111.11111111" \
    "10.0.0.0/8 00000000.00000000.00000000" \
    "10.0.0.1 00000000.00000000.00000001" \
    "10.255.255.254 11111111.11111111.11111110" \
    "10.255.255.255 11111111.11111111.11111111" \
    "16777214" \
    "Class A, Private network (RFC1918)" \
    lines
}
